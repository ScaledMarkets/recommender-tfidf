<!--
	This pom file builds the behavioral tests. They execute in a separate runtime
	from the application, so they have different dependencies and thus need their
	own pom file.
	
	Do not run this pom file directly. It must be run from the makefile, because
	the makefile sets shell variables that are used by this pom:
		bdd_test_dir - test source code directory.
		bdd_test_build_dir - test target class file directory.

	This pom is self-contained - it does not rely on a maven configuration (settings.xml).
	
	This pom overrides the standard source and target locations.
	-->

<project>

	<modelVersion>4.0.0</modelVersion>
	
	<groupId>com.scaledmarkets.recommenders</groupId>
	<artifactId>usersimrec-bddtests</artifactId>
	<version>1.0</version>
	
	<properties>
		<maven.compiler.source>${JavaVersion}</maven.compiler.source>
		<maven.compiler.target>${JavaVersion}</maven.compiler.target>
		<cucumber-jvm.version>1.1.5</cucumber-jvm.version>
	</properties>
	
	<repositories>
	
		<repository>
			<id>central</id>
			<name>Maven Repository Switchboard</name>
			<layout>default</layout>
			<url>http://repo1.maven.org/maven2</url>
			<snapshots>
				<enabled>false</enabled>
			</snapshots>
		</repository>
	
		<repository>
			<id>repository-apache-org</id>
			<name>Apache Repository</name>
			<url>https://repository.apache.org/content/groups/public/</url>
			<releases>
				<enabled>true</enabled>
				<updatePolicy>never</updatePolicy>
			</releases>
			<snapshots>
				<enabled>false</enabled>
				<updatePolicy>daily</updatePolicy>
			</snapshots>
		</repository>
	
		<repository>
			<id>java-net-public</id>
			<name>Java Net Public</name>
			<url>https://maven.java.net/content/groups/public/</url>
			<releases>
				<enabled>true</enabled>
				<updatePolicy>never</updatePolicy>
			</releases>
			<snapshots>
				<enabled>false</enabled>
				<updatePolicy>daily</updatePolicy>
			</snapshots>
		</repository>
		
		<!-- For local dependency: the message types used by the recommender service. -->
		<repository>
			<id>Recommenders</id>
			<url>file://${env.jar_dir}</url>		
		</repository>
		
	</repositories>
	
	<dependencies>
	
		<dependency>
			<groupId>info.cukes</groupId>
			<artifactId>cucumber-java</artifactId>
			<version>1.2.5</version>
			<scope>provided</scope>
		</dependency>		
		
		<dependency>
			<groupId>info.cukes</groupId>
			<artifactId>cucumber-core</artifactId>
			<version>1.2.5</version>
			<scope>provided</scope>
		</dependency>		
		
		<dependency>
			<groupId>info.cukes</groupId>
			<artifactId>cucumber-jvm-deps</artifactId>
			<version>1.0.5</version>
			<scope>provided</scope>
		</dependency>		
		
		<dependency>
			<groupId>info.cukes</groupId>
			<artifactId>gherkin</artifactId>
			<version>2.12.2</version>
			<scope>provided</scope>
		</dependency>
		
		<!--
		<dependency>
			<groupId>jdk.tools</groupId>
			<artifactId>jdk.tools</artifactId>
			<version>1.8</version>
			<scope>system</scope>
			<systemPath>${env.MVN_JDKToolLib}/tools.jar</systemPath>
		</dependency> 
		-->
		
		<dependency>
			<groupId>mysql</groupId>
			<artifactId>mysql-connector-java</artifactId>
			<version>5.1.6</version>
		</dependency>
		
		<dependency>
			<groupId>javax.ws.rs</groupId>
			<artifactId>javax.ws.rs-api</artifactId>
			<version>2.1</version>
		</dependency>
		
		<dependency>
			<groupId>org.glassfish.jersey.core</groupId>
			<artifactId>jersey-client</artifactId>
			<version>2.26</version>
		</dependency>
		
		<dependency>
			<groupId>org.glassfish.jersey.inject</groupId>
			<artifactId>jersey-hk2</artifactId>
			<version>2.26</version>
		</dependency>
		
		<dependency>
			<groupId>javax.activation</groupId>
			<artifactId>activation</artifactId>
			<version>1.1.1</version>
		</dependency>
		
		<dependency>
			<groupId>com.google.code.gson</groupId>
			<artifactId>gson</artifactId>
			<version>2.8.2</version>
		</dependency>
	
		<!-- Local dependency: the message types used by the recommender service. -->
		<dependency>
			<groupId>${env.GROUPNAME}</groupId>
			<artifactId>${env.PROJECTNAME}-messages</artifactId>
			<version>${env.VERSION}</version>
		</dependency>
		
	</dependencies>

	<build>
	
		<sourceDirectory>${env.bdd_test_dir}</sourceDirectory>
		<directory>${env.bdd_test_maven_build_dir}</directory>
		
		<plugins>
		
			<!-- JDK toolchain -->
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-toolchains-plugin</artifactId>
				<version>1.1</version>
				<executions>
					<execution>
						<phase>validate</phase>   <!-- https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html -->
						<goals>
							<goal>toolchain</goal>
						</goals>
					</execution>
				</executions>
				<configuration>
					<toolchains>
						<jdk>
							<version>${env.JavaVersion}</version>
						</jdk>
					</toolchains>
				</configuration>
			</plugin>
			
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-compiler-plugin</artifactId>
				<version>3.7.0</version>
				<configuration>
					<fork>true</fork>
					<verbose>true</verbose>
					<compilerArguments>
						<Xmaxerrs>${env.maxerrs}</Xmaxerrs>
					</compilerArguments>
					<source>${env.JavaVersion}</source>
					<target>${env.JavaVersion}</target>
				</configuration>
			</plugin>
			
		</plugins>
		
	</build>
	
</project>
